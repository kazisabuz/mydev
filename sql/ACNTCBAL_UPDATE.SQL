SELECT P.PBDCONT_ENTITY_NUM,
       P.PBDCONT_DEP_AC_NUM,
       P.PBDCONT_CONT_NUM,
       p.PBDCONT_BC_DEP_AMT
  FROM PBDCONTRACT P
 WHERE     P.PBDCONT_ENTITY_NUM = 1
       AND (P.PBDCONT_DEP_AC_NUM, P.PBDCONT_CONT_NUM) IN
              (  SELECT PBDCONT_DEP_AC_NUM, MAX (PBDCONT_CONT_NUM)
                   FROM PBDCONTRACT, ACTUAL_ACCOUNT_UPDATE
                  WHERE     IACLINK_INTERNAL_ACNUM = PBDCONT_DEP_AC_NUM
                        AND PBDCONT_ENTITY_NUM = 1
                        AND SL = 1
                        AND PBDCONT_CONT_NUM > 0
               GROUP BY PBDCONT_DEP_AC_NUM);
			   
			   
------------ UPDATE ---------------



BEGIN 
FOR IDX IN (
SELECT P.PBDCONT_ENTITY_NUM,
       P.PBDCONT_DEP_AC_NUM,
       P.PBDCONT_CONT_NUM,
       p.PBDCONT_BC_DEP_AMT
  FROM PBDCONTRACT P
 WHERE     P.PBDCONT_ENTITY_NUM = 1
       AND (P.PBDCONT_DEP_AC_NUM, P.PBDCONT_CONT_NUM) IN
              (  SELECT PBDCONT_DEP_AC_NUM, MAX (PBDCONT_CONT_NUM)
                   FROM PBDCONTRACT, ACTUAL_ACCOUNT_UPDATE
                  WHERE     IACLINK_INTERNAL_ACNUM = PBDCONT_DEP_AC_NUM
                        AND PBDCONT_ENTITY_NUM = 1
                        AND SL = 1
                        AND PBDCONT_CONT_NUM > 0
               GROUP BY PBDCONT_DEP_AC_NUM) ) LOOP 
               UPDATE ACNTCBAL SET 
               ACNTCBAL_BC_CUR_DB_SUM = IDX.PBDCONT_BC_DEP_AMT, 
               ACNTCBAL_BC_CUR_CR_SUM = IDX.PBDCONT_BC_DEP_AMT, 
               ACNTCBAL_AC_BAL = IDX.PBDCONT_BC_DEP_AMT, 
               ACNTCBAL_BC_BAL = IDX.PBDCONT_BC_DEP_AMT
               WHERE ACNTCBAL_ENTITY_NUM = IDX.PBDCONT_ENTITY_NUM, 
               ACNTCBAL_INTERNAL_ACNUM = IDX.PBDCONT_DEP_AC_NUM, 
               ACNTCBAL_CONTRACT_NUM = IDX.PBDCONT_CONT_NUM ;
END LOOP ;
END ;