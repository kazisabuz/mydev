CREATE TABLE CBISS_ACTUAL_AC
AS
   SELECT *
     FROM CBISS
    WHERE     CBISS_ENTITY_NUM = 1
          AND CBISS_CLIENT_ACNUM IN
                 (SELECT IACLINK_INTERNAL_ACNUM FROM ACTUAL_ACCOUNT_UPDATE);

-- CBISS

DECLARE
   V_COUNT    NUMBER := 0;
   V_AC_NUM   NUMBER;
BEGIN
   FOR IDX
      IN (  SELECT * FROM ACTUAL_ACCOUNT_UPDATE)
   LOOP
      IF IDX.SL = 1
      THEN
         V_AC_NUM := IDX.IACLINK_INTERNAL_ACNUM;
      END IF;

      UPDATE CBISS
         SET CBISS_CLIENT_ACNUM = V_AC_NUM
       WHERE     CBISS_ENTITY_NUM = 1
             AND CBISS_CLIENT_ACNUM = IDX.IACLINK_INTERNAL_ACNUM;
   END LOOP;
END;


-- STOPCHQ


CREATE TABLE STOPCHQ_ACTUAL_AC
AS
   SELECT *
     FROM STOPCHQ
    WHERE     STOPCHQ_ENTITY_NUM = 1
          AND STOPCHQ_INTERNAL_AC_NUM IN
                 (SELECT IACLINK_INTERNAL_ACNUM FROM ACTUAL_ACCOUNT_UPDATE);

DECLARE
   V_COUNT    NUMBER := 0;
   V_AC_NUM   NUMBER;
BEGIN
   FOR IDX
      IN (  SELECT * FROM ACTUAL_ACCOUNT_UPDATE)
   LOOP
      IF IDX.SL = 1
      THEN
         V_AC_NUM := IDX.IACLINK_INTERNAL_ACNUM;
      END IF;

      UPDATE STOPCHQ
         SET STOPCHQ_INTERNAL_AC_NUM = V_AC_NUM
       WHERE     STOPCHQ_ENTITY_NUM = 1
             AND STOPCHQ_INTERNAL_AC_NUM = IDX.IACLINK_INTERNAL_ACNUM;
   END LOOP;
END;


-- CHQUSG


CREATE TABLE CHQUSG_ACTUAL_AC
AS
   SELECT *
     FROM CHQUSG
    WHERE     CHQUSG_ENTITY_NUM = 1
          AND CHQUSG_INTERNAL_AC_NUM IN
                 (SELECT IACLINK_INTERNAL_ACNUM FROM ACTUAL_ACCOUNT_UPDATE);

DECLARE
   V_COUNT    NUMBER := 0;
   V_AC_NUM   NUMBER;
BEGIN
   FOR IDX
      IN (  SELECT * FROM ACTUAL_ACCOUNT_UPDATE)
   LOOP
      IF IDX.SL = 1
      THEN
         V_AC_NUM := IDX.IACLINK_INTERNAL_ACNUM;
      END IF;

      UPDATE CHQUSG
         SET CHQUSG_INTERNAL_AC_NUM = V_AC_NUM
       WHERE     CHQUSG_ENTITY_NUM = 1
             AND CHQUSG_INTERNAL_AC_NUM = IDX.IACLINK_INTERNAL_ACNUM;
   END LOOP;
END;