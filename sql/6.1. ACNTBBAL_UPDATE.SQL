  SELECT ACNTVBBAL_YEAR,
         ACNTVBBAL_MONTH,
         ACNTVBBAL_AC_OPNG_DB_SUM - MW_DR_SUM,
         ACNTVBBAL_AC_OPNG_CR_SUM - MW_CR_SUM,
         ACNTVBBAL_BC_OPNG_DB_SUM - MW_DR_SUM,
         ACNTVBBAL_BC_OPNG_CR_SUM - MW_CR_SUM
    FROM MONTHS_WISE_AC_BALANCE, ACNTVDBBAL
   WHERE     ACNTVBBAL_ENTITY_NUM = 1
         AND ACNTVBBAL_INTERNAL_ACNUM = INT_AC_NO
         AND ACNTVBBAL_YEAR = TRANSACTION_YEAR
         AND ACNTVBBAL_MONTH = TRANSACTION_MONTHS
         AND (   ACNTVBBAL_AC_OPNG_DB_SUM <> MW_DR_SUM
              OR ACNTVBBAL_AC_OPNG_CR_SUM <> MW_CR_SUM
              OR ACNTVBBAL_BC_OPNG_DB_SUM <> MW_DR_SUM
              OR ACNTVBBAL_BC_OPNG_CR_SUM <> MW_CR_SUM)
ORDER BY INT_AC_NO, TRANSACTION_YEAR, TRANSACTION_MONTHS ;



BEGIN
   FOR IDX IN (  SELECT *
                   FROM MONTHS_WISE_AC_BALANCE
               ORDER BY INT_AC_NO, TRANSACTION_YEAR, TRANSACTION_MONTHS)
   LOOP
      UPDATE ACNTBBAL
         SET ACNTBBAL_AC_OPNG_DB_SUM = IDX.MW_DR_SUM,
             ACNTBBAL_AC_OPNG_CR_SUM = IDX.MW_CR_SUM,
             ACNTBBAL_BC_OPNG_DB_SUM = IDX.MW_DR_SUM,
             ACNTBBAL_BC_OPNG_CR_SUM = IDX.MW_CR_SUM
       WHERE     ACNTBBAL_ENTITY_NUM = 1
             AND ACNTBBAL_INTERNAL_ACNUM = IDX.INT_AC_NO
             AND ACNTBBAL_YEAR = IDX.TRANSACTION_YEAR 
             AND ACNTBBAL_MONTH = IDX.TRANSACTION_MONTHS;
   END LOOP;
END;
/




BEGIN
   FOR IDX IN (  SELECT *
                   FROM MONTHS_WISE_AC_BALANCE
               ORDER BY INT_AC_NO, TRANSACTION_YEAR, TRANSACTION_MONTHS)
   LOOP
      UPDATE ACNTVDBBAL
         SET ACNTVBBAL_AC_OPNG_DB_SUM = IDX.MW_DR_SUM,
             ACNTVBBAL_AC_OPNG_CR_SUM = IDX.MW_CR_SUM,
             ACNTVBBAL_BC_OPNG_DB_SUM = IDX.MW_DR_SUM,
             ACNTVBBAL_BC_OPNG_CR_SUM = IDX.MW_CR_SUM
       WHERE     ACNTVBBAL_ENTITY_NUM = 1
             AND ACNTVBBAL_INTERNAL_ACNUM = IDX.INT_AC_NO
             AND ACNTVBBAL_YEAR = IDX.TRANSACTION_YEAR 
             AND ACNTVBBAL_MONTH = IDX.TRANSACTION_MONTHS;
   END LOOP;
END;
/
